#:kivy 2.3.0
# ==========================================================
#                  CLASS DEFINITIONS (TOP LEVEL)
# ==========================================================

# --------------------------
# SPLIT SCREEN UI DEFINITION
# --------------------------
# This defines what the SplitScreen looks like in the app.
# It must be declared at the top level (outside ScreenManager).
<SplitScreen>:
    name: "split"

    BoxLayout:
        orientation: "vertical"
        spacing: 10
        padding: 10

        Label:
            text: "üìÑ Select a PDF and enter split page number"
            size_hint_y: None
            height: 40
            color: (0.2, 0.2, 0.2, 1)

        ScrollView:
            GridLayout:
                id: split_grid
                cols: 1
                size_hint_y: None
                height: self.minimum_height
                row_default_height: 40
                spacing: 10

        Button:
            text: "Process Split"
            size_hint_y: None
            height: 50
            background_color: (0.2, 0.5, 1, 1)
            color: (1, 1, 1, 1)
            on_press: root.process_split()


# --------------------------
# NAV ICON UI DEFINITION
# --------------------------
# Custom icon-button widget for bottom navigation bar.
<NavIcon@ButtonBehavior+BoxLayout>:
    source: ""
    text: ""
    on_press: None
    orientation: "vertical"
    padding: 5
    spacing: 2

    Image:
        id: icon_img
        source: root.source
        allow_stretch: True
        keep_ratio: True
        size_hint_y: 0.8

    Label:
        text: root.text if not icon_img.texture else ""
        color: (0.1, 0.1, 0.1, 1)
        font_size: 12
        halign: "center"
        valign: "middle"



# ==========================================================
#                  MAIN APP LAYOUT (ROOT)
# ==========================================================
<PDFhubRoot>:
    orientation: "vertical"
    padding: 10
    spacing: 5

    # --- Background ---
    canvas.before:
        Color:
            rgba: 0.97, 0.97, 0.97, 1
        Rectangle:
            pos: self.pos
            size: self.size


    # --- Search Bar (Top) ---
    BoxLayout:
        size_hint_y: 0.08
        spacing: 10
        canvas.before:
            Color:
                rgba: 0.94, 0.94, 0.94, 1
            RoundedRectangle:
                pos: self.pos
                size: self.size
                radius: [8]
        TextInput:
            hint_text: "Search PDFs..."
            background_color: (0, 0, 0, 0)
            foreground_color: (0.2, 0.2, 0.2, 1)
            font_size: 16
            padding: 15, 10


    # --- Screen Manager (Main Tabs) ---
    ScreenManager:
        id: screen_manager

        HomeScreen:
            name: "home"
            BoxLayout:
                orientation: "vertical"
                Label:
                    text: "üìÑ Home ‚Äì Recently opened PDFs"
                    color: (0.1, 0.1, 0.1, 1)
                    font_size: 20

        EditScreen:
            name: "edit"
            BoxLayout:
                orientation: "vertical"
                Label:
                    text: "‚úèÔ∏è Edit PDFs / Add Signatures"
                    color: (0.1, 0.1, 0.1, 1)
                    font_size: 20

        SplitScreen:
            name: "split"

        MergeScreen:
            name: "merge"
            BoxLayout:
                orientation: "vertical"
                Label:
                    text: "üìé Merge multiple PDFs"
                    color: (0.1, 0.1, 0.1, 1)
                    font_size: 20

        SettingsScreen:
            name: "settings"
            BoxLayout:
                orientation: "vertical"
                Label:
                    text: "‚öôÔ∏è App Settings"
                    color: (0.1, 0.1, 0.1, 1)
                    font_size: 20


    # --- Bottom Navigation Bar ---
    BoxLayout:
        size_hint_y: 0.1
        spacing: 25
        padding: [40, 5]
        canvas.before:
            Color:
                rgba: 0.92, 0.95, 0.98, 1
            Rectangle:
                pos: self.pos
                size: self.size

        NavIcon:
            source: "assets/icons/home.png"
            text: "Home"
            on_press: root.switch_tab("home")

        NavIcon:
            source: "assets/icons/edit.png"
            text: "Edit"
            on_press: root.switch_tab("edit")

        NavIcon:
            source: "assets/icons/split.png"
            text: "Split"
            on_press: root.switch_tab("split")

        NavIcon:
            source: "assets/icons/merge.png"
            text: "Merge"
            on_press: root.switch_tab("merge")

        NavIcon:
            source: "assets/icons/settings.png"
            text: "Settings"
            on_press: root.switch_tab("settings")
